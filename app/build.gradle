apply plugin: 'com.android.application'
apply plugin: 'realm-android'

android {
    dexOptions {
        javaMaxHeapSize "2g"
        jumboMode true
    }

    packagingOptions {
        exclude 'META-INF/NOTICE'
        exclude 'META-INF/NOTICE.txt'
        exclude 'META-INF/LICENSE'
        exclude 'META-INF/LICENSE.txt'
    }

    lintOptions {
        disable 'MissingTranslation'
    }

    signingConfigs {
        prodKey {
            keyAlias 'saldomuprod'
            keyPassword 'saldomukey590'
            storePassword 'saldomustore590'
            storeFile file('saldomu-key.jks')
        }
    }
    compileSdkVersion 25
    buildToolsVersion "25.0.3"

    defaultConfig {
        applicationId "com.sgo.saldomu"
        minSdkVersion 16
        targetSdkVersion 25
        versionCode 1
        versionName "1.0"

        // Enabling multidex support.
        multiDexEnabled true
        buildConfigField 'String', "flavorDev", "\"development\""
        buildConfigField 'String ', "flavorProd", "\"production\""
        testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner"

    }

    android {
        useLibrary 'org.apache.http.legacy'
    }
    productFlavors {
        development {
            applicationId "com.sgo.saldomudev"
            resValue "string", "appname", "DEV Saldomu"
            resValue "string", "dbname", "DevSaldomu.db"
            resValue "integer", "dbversion", "0"
            resValue "string", "realmname", "com.saldomudev.realm"
            resValue "integer", "realscheme", "0"
            resValue "string", "realmBillerName", "saldomudevrealm.realm"
            resValue "integer", "realBillerscheme", "0"
            resValue "string", "realmBBSName", "saldomudevbbs.realm"
            resValue "integer", "realBBScheme", "0"
            buildConfigField 'boolean', "isProdDomain", "false"
            buildConfigField 'String', "commCodeBBSATC", "\"EMOMSCADM\""
//            buildConfigField 'String', "HeadAddress", "\"192.168.88.22:59088/\""
            buildConfigField 'String', "HeadAddress", "\"https://mobile-dev.espay.id/\""
            buildConfigField 'String', "TOPIC_FCM_ALL_DEVICE", "\"allAndroidApp\""
            buildConfigField 'String', "UrlMNotif", "\"http://192.168.86.116:8114/\""

            versionCode = 1
            versionName "1.0"
            buildConfigField 'String', "AppID", "\"SDOM\""
        }
        production {
            applicationId "com.sgo.saldomu"
            resValue "string", "appname", "Saldomu"
            resValue "string", "dbname", "saldomu.db"
            resValue "string", "realmname", "com.sgo.saldomu.realm"
            resValue "integer", "realscheme", "0"
            resValue "string", "realmBillerName", "saldomurealm.realm"
            resValue "integer", "realBillerscheme", "0"
            resValue "string", "realmBBSName", "saldomubbs.realm"
            resValue "integer", "realBBScheme", "0"
            resValue "integer", "dbversion", "0"
            buildConfigField 'boolean', "isProdDomain", "true"

            buildConfigField 'String', "commCodeBBSATC", "\"SALDOMU\""
//            buildConfigField 'String', "HeadAddress", "\"https://mobile.goworld.asia/akardaya2/\""
            buildConfigField 'String', "HeadAddress", "\"https://mobile.espay.id/\""
            buildConfigField 'String', "TOPIC_FCM_ALL_DEVICE", "\"allAndroidAppProd\""
            buildConfigField 'String', "UrlMNotif", "\"https://mobile.espay.id/mnotif/\""

            signingConfig signingConfigs.prodKey
            versionCode = 8
            versionName "1.6"
            buildConfigField 'String', "AppID", "\"SDOM\""
        }
    }

    buildTypes {
        release {
            minifyEnabled true
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
            signingConfig signingConfigs.prodKey
        }
        debug {
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }
    }

    applicationVariants.all { variant ->
        def fileName
        if (variant.baseName.contains("development")) {
            fileName = "Dev Saldomu"
        } else {
            fileName = "Saldomu"
        }
        variant.outputs.each { output ->
            def apk = output.outputFile;
            def newName = fileName + "-${variant.mergedFlavor.versionName}"
            if (variant.buildType.name.contains("release")) {
//                newName += "-${variant.buildType.versionNameSuffix}"
                newName += "- release"
            } else {
                newName += "- debug"
            }

//            if (output.zipAlign) {
//                output.zipAlign.outputFile = new File((File) apk.parentFile, newName + '.apk');
//            }
            output.packageApplication.outputFile = new File((File) apk.parentFile, newName + ".apk")
        }
    }
}

dependencies {
    compile fileTree(dir: 'libs', include: ['*.jar'])
    //module dependencies
    compile project(':PinMaster')
    compile project(':PinnedSectionList')
    compile project(':VPI')
    compile project(':SecurePref')

    //Android lib
    compile 'com.android.support:cardview-v7:25.3.1'
    compile 'com.android.support:customtabs:25.3.1'
    compile 'com.android.support:recyclerview-v7:25.3.1'
    compile 'com.android.support:appcompat-v7:25.3.1'
    compile 'com.android.support:support-v4:25.3.1'
    compile 'com.android.support:design:25.3.1'
    compile 'com.android.support:multidex:1.0.1'
    compile 'com.android.support.constraint:constraint-layout:1.0.0-beta3'
    //UI UX
    compile 'com.balysv:material-ripple:1.0.2'
    compile 'com.lsjwzh:materialloadingprogressbar:0.5.8-RELEASE'
    compile 'com.u1aryz:android-newpopupmenu-lib:1.0.1'
    compile 'com.wdullaer:materialdatetimepicker:1.5.4'
    compile 'com.joanzapata.iconify:android-iconify-fontawesome:2.1.0'
    compile 'com.github.paolorotolo:appintro:3.4.0'
    compile 'com.txusballesteros:FitChart:1.0'
    compile 'com.gordonwong:material-sheet-fab:1.2'
    compile 'com.faber.circlestepview:library:1.0.0@aar'
    compile 'com.squareup:android-times-square:1.6.5@aar'
    compile 'com.sothree.slidinguppanel:library:3.3.1'
    //Utilitize
    compile 'in.srain.cube:ultra-ptr:1.0.11'
    compile 'com.dlazaro66.qrcodereaderview:qrcodereaderview:1.0.0'
    compile 'com.klinkerapps:android-chips:1.0.1@aar'
    compile 'com.github.bumptech.glide:glide:3.7.0'
    compile 'org.ocpsoft.prettytime:prettytime:4.0.1.Final'
    compile 'commons-codec:commons-codec:1.10'
    compile 'com.jakewharton.timber:timber:4.1.0'
    compile 'commons-io:commons-io:2.4'
    compile 'joda-time:joda-time:2.9.3'
    compile 'pub.devrel:easypermissions:0.4.2'
    //ORM
    compile 'com.michaelpardo:activeandroid:3.1.0-SNAPSHOT'
    //Json Engine
    compile 'com.google.code.gson:gson:2.7'
    //Network
    compile 'com.loopj.android:android-async-http:1.4.8'
    compile 'com.squareup.okhttp:okhttp:2.5.0'
    //Realm
    compile 'com.facebook.stetho:stetho:1.5.0'
    compile 'com.uphyca:stetho_realm:2.1.0'
    compile 'io.realm:android-adapters:2.0.0'
    //Firebase
    compile 'com.google.firebase:firebase-core:11.2.0'
    compile 'com.google.firebase:firebase-crash:11.2.0'
    compile 'com.google.firebase:firebase-messaging:11.2.0'
    compile 'com.firebase:firebase-jobdispatcher:0.8.0'
    //Google Maps
    compile 'com.google.android.gms:play-services-maps:11.2.0'
    compile 'com.google.android.gms:play-services-location:11.2.0'
    compile 'com.google.android.gms:play-services-places:11.2.0'
    //Testing Lib
    testCompile 'org.hamcrest:hamcrest-library:1.3'
    testCompile 'junit:junit:4.12'
    testCompile 'org.mockito:mockito-core:1.10.19'
    androidTestCompile 'org.hamcrest:hamcrest-library:1.3'
    androidTestCompile 'com.android.support.test.espresso:espresso-core:2.2.2'
    androidTestCompile 'com.android.support:support-annotations:25.3.1'
    androidTestCompile 'com.android.support.test:runner:0.5'
    androidTestCompile 'com.android.support.test:rules:0.5'
}
apply plugin: 'com.google.gms.google-services'
